<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ù„ÙˆØ­Ø© Ù…ØªØ§Ø¨Ø¹Ø© ØªÙ†ÙÙŠØ° Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ Ø¨Ù…Ø¯Ø±Ø³Ø© Ø§Ù„Ø¯ÙÙŠ Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠØ© - Ù…Ø¯Ø±Ø³Ø© Ø§Ù„Ø¯ÙÙŠ</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Ù…ÙƒØªØ¨Ø§Øª Ø±Ø¦ÙŠØ³ÙŠØ© -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <link rel="stylesheet" href="https://cdn.datatables.net/2.0.3/css/dataTables.dataTables.min.css">
    <script src="https://cdn.datatables.net/2.0.3/js/dataTables.min.js"></script>

    <!-- Ù…ÙƒØªØ¨Ø§Øª Ø§Ù„ØªØµØ¯ÙŠØ± -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>

    <style>
        * { box-sizing: border-box; }
        body {
            margin: 0;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            background: #f1f5f9;
            direction: rtl;
        }
        .app-shell {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        header {
            background: radial-gradient(circle at top right, #2563eb, #0f172a);
            color: #fff;
            padding: 14px 22px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 2px 10px rgba(15,23,42,0.35);
        }
        header .title-block {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }
        header h1 {
            margin: 0;
            font-size: 2.4rem; /* enlarged */
        }
        header span {
            font-size: 0.85rem;
            opacity: 0.9;
        }
        .header-tags {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        .tag {
            padding: 4px 10px;
            border-radius: 999px;
            font-size: 0.75rem;
            border: 1px solid rgba(148,163,184,0.9);
            background: rgba(15,23,42,0.45);
        }
        main {
            padding: 16px 10px 22px;
        }
        .main-inner {
            max-width: 1400px;
            margin: 0 auto;
        }

        /* KPIs */
        .kpi-row {
            display: grid;
            grid-template-columns: repeat(3, minmax(0,1fr));
            gap: 14px;
            margin: 10px 4px 18px;
        }
        @media (max-width: 900px) {
            .kpi-row {
                grid-template-columns: repeat(2, minmax(0,1fr));
            }
        }
        .kpi-card {
            border-radius: 18px;
            padding: 16px 18px;
            position: relative;
            overflow: hidden;
            color: #0f172a;
        }
        .kpi-card::before {
            content: "";
            position: absolute;
            inset: 0;
            opacity: 0.2;
        }
        .kpi-green { background: #dcfce7; }
        .kpi-green::before { background: radial-gradient(circle at top right, #22c55e, transparent); }
        .kpi-blue { background: #dbeafe; }
        .kpi-blue::before { background: radial-gradient(circle at top right, #3b82f6, transparent); }
        .kpi-amber { background: #fef3c7; }
        .kpi-amber::before { background: radial-gradient(circle at top right, #f59e0b, transparent); }
        .kpi-inner {
            position: relative;
            z-index: 1;
        }
        .kpi-label {
            font-size: 0.85rem;
            color: #475569;
            margin-bottom: 6px;
        }
        .kpi-value {
            font-size: 2rem;
            font-weight: 800;
        }
        .kpi-sub {
            font-size: 0.75rem;
            color: #6b7280;
            margin-top: 2px;
        }

        /* Layout blocks */
        .top-grid {
            display: grid;
            grid-template-columns: minmax(0, 1.15fr) minmax(0, 2fr);
            gap: 14px;
            margin: 0 4px 16px;
        }
        @media (max-width: 1024px) {
            .top-grid {
                grid-template-columns: minmax(0,1fr);
            }
        }
        .card {
            background: #ffffff;
            border-radius: 16px;
            padding: 14px 16px;
            box-shadow: 0 1px 4px rgba(15,23,42,0.08);
        }
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
            gap: 8px;
        }
        .card-title {
            font-size: 1.4rem; /* enlarged */
            font-weight: 600;
            color: #0f172a;
        }
        .pill {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 3px 10px;
            border-radius: 999px;
            border: 1px solid rgba(148,163,184,0.9);
            font-size: 0.75rem;
            color: #475569;
            background: #f9fafb;
        }
        .header-actions {
            display: flex;
            gap: 6px;
            align-items: center;
            flex-wrap: wrap;
        }
        .btn-secondary {
            padding: 6px 12px;
            border-radius: 999px;
            border: 1px solid #cbd5e1;
            background: #eef2ff;
            font-size: 0.8rem;
            cursor: pointer;
        }
        .btn-secondary:hover {
            background: #e0e7ff;
        }
        .btn-danger {
            padding: 6px 12px;
            border-radius: 999px;
            border: 1px solid #fecaca;
            background: #fee2e2;
            font-size: 0.8rem;
            cursor: pointer;
            color: #b91c1c;
        }
        .btn-danger:hover {
            background: #fecaca;
        }

        /* Form */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(4, minmax(0,1fr));
            gap: 8px 10px;
            align-items: flex-end;
            margin-top: 4px;
        }
        .form-grid .full { grid-column: span 4; }
        @media (max-width: 900px) {
            .form-grid {
                grid-template-columns: repeat(2, minmax(0,1fr));
            }
            .form-grid .full { grid-column: span 2; }
        }
        .form-grid label {
            display: block;
            font-size: 0.8rem;
            color: #475569;
            margin-bottom: 3px;
        }
        .form-grid input,
        .form-grid select,
        .form-grid textarea {
            width: 100%;
            padding: 7px 9px;
            border-radius: 10px;
            border: 1px solid #cbd5e1;
            font-family: inherit;
            font-size: 0.85rem;
            background: #f9fafb;
        }
        .form-grid input:focus,
        .form-grid select:focus,
        .form-grid textarea:focus {
            outline: 2px solid #2563eb33;
            border-color: #2563eb;
            background: #ffffff;
        }
        .form-grid textarea {
            min-height: 40px;
            resize: vertical;
        }
        .btn-primary {
            padding: 9px 20px;
            border-radius: 999px;
            border: none;
            background: linear-gradient(135deg, #2563eb, #1d4ed8);
            color: #fff;
            font-size: 0.85rem;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }
        .btn-primary span.icon {
            font-size: 1rem;
        }
        .btn-primary:hover { filter: brightness(1.05); }
        .week-date-hint {
            font-size: 0.75rem;
            color: #64748b;
            margin-top: 4px;
        }

        /* Filters & table */
        .filter-row {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 4px 0 10px;
        }
        .filter-item { min-width: 180px; }
        .filter-item label {
            display: block;
            font-size: 0.75rem;
            color: #64748b;
            margin-bottom: 3px;
        }
        .filter-item select {
            width: 100%;
            padding: 6px 10px;
            border-radius: 999px;
            border: 1px solid #cbd5e1;
            font-size: 0.8rem;
            background: #f9fafb;
        }
        .filter-item select:focus {
            outline: 2px solid #2563eb33;
            border-color: #2563eb;
            background: #ffffff;
        }

        table.dataTable thead th {
            background: #e0e7ff;
        }
        table.dataTable tbody td {
            font-size: 0.9rem;
        }
        table#tasksTable th:nth-child(4),
        table#tasksTable td:nth-child(4) {
            min-width: 160px;
        }
        table#tasksTable th:nth-child(5),
        table#tasksTable td:nth-child(5) {
            min-width: 170px;
        }
        #tasksTable_wrapper {
            font-size: 0.85rem;
        }
        .footer-note {
            margin-top: 6px;
            font-size: 0.7rem;
            color: #94a3b8;
            text-align: left;
        }
        .week-date-pill {
            display: inline-flex;
            align-items: center;
            padding: 4px 10px;
            border-radius: 999px;
            background: #eef2ff;
            font-size: 0.8rem;
            color: #1e293b;
        }

        /* Charts */
        .charts-grid {
            display: grid;
            grid-template-columns: minmax(0,1fr) minmax(0,1fr);
            gap: 12px;
        }
        @media (max-width: 900px) {
            .charts-grid {
                grid-template-columns: minmax(0,1fr);
            }
        }

        /* Ø²Ø± Ø­Ø°Ù ØµÙ */
        .btn-delete {
            border: none;
            border-radius: 999px;
            padding: 2px 8px;
            cursor: pointer;
            background: transparent;
            font-size: 1rem;
        }
        .btn-delete:hover {
            background: #fee2e2;
        }

        /* ØªÙ„ÙˆÙŠÙ† Ø§Ù„ØµÙÙˆÙ Ø­Ø³Ø¨ Ø­Ø§Ù„Ø© Ø§Ù„ØªÙ†ÙÙŠØ° */
        .row-done td {
            background-color: #dcfce7 !important;
        }
        .row-progress td {
            background-color: #fef9c3 !important;
        }
        .row-late td {
            background-color: #fee2e2 !important;
        }
    
    /* login screen */
    .login-shell {
        position: fixed;
        inset: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        background: linear-gradient(135deg, #003f72, #0f766e);
        z-index: 9999;
    }
    .login-card {
        background: #f9fafb;
        color: #0f172a;
        border-radius: 18px;
        padding: 24px 22px 20px;
        width: 100%;
        max-width: 380px;
        box-shadow: 0 18px 40px rgba(15,23,42,0.35);
        border: 1px solid rgba(148,163,184,0.9);
        text-align: center;
    }
    .login-title {
        font-size: 1.4rem;
        font-weight: 700;
        margin-bottom: 4px;
    }
    .login-subtitle {
        font-size: 0.85rem;
        color: #64748b;
        margin-bottom: 14px;
    }
    .login-badge {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        padding: 3px 10px;
        border-radius: 999px;
        background: rgba(22,163,74,0.10);
        border: 1px solid rgba(34,197,94,0.7);
        font-size: 0.7rem;
        margin-bottom: 14px;
    }
    .login-field {
        text-align: right;
        margin-bottom: 10px;
    }
    .login-field label {
        display: block;
        font-size: 0.8rem;
        margin-bottom: 4px;
    }
    .login-field input {
        width: 100%;
        padding: 8px 10px;
        border-radius: 999px;
        border: 1px solid #cbd5e1;
        background: #ffffff;
        color: #0f172a;
        font-family: inherit;
        font-size: 0.85rem;
    }
    .login-field input:focus {
        outline: 2px solid #0f766e;
        border-color: #0f766e;
    }
    .login-button {
        width: 100%;
        padding: 9px 12px;
        border-radius: 999px;
        border: none;
        cursor: pointer;
        background: linear-gradient(135deg, #0f766e, #22c55e);
        color: #ecfdf5;
        font-weight: 700;
        font-size: 0.95rem;
        margin-top: 6px;
    }
    .login-button:hover {
        filter: brightness(1.05);
    }
    .login-hint {
        margin-top: 10px;
        font-size: 0.75rem;
        color: #64748b;
    }
    .login-error {
        margin-top: 8px;
        font-size: 0.8rem;
        color: #fecaca;
        background: rgba(239,68,68,0.12);
        border-radius: 999px;
        padding: 4px 10px;
        text-align: center;
        display: none;
    }
</style>
</head>
<body>

<div id="loginScreen" class="login-shell">
    <div class="login-card">
        <div class="login-title">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</div>
        <div class="login-subtitle">Ù„ÙˆØ­Ø© Ù…ØªØ§Ø¨Ø¹Ø© ØªÙ†ÙÙŠØ° Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ Ø¨Ù…Ø¯Ø±Ø³Ø© Ø§Ù„Ø¯ÙÙŠ Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠØ©</div>
        <div class="login-badge">ÙˆØµÙˆÙ„ Ø¥Ø¯Ø§Ø±ÙŠ</div>
        <form id="loginForm">
            <div class="login-field">
                <label for="username">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</label>
                <input type="text" id="username" autocomplete="off" placeholder="Ø§Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
            </div>
            <div class="login-field">
                <label for="password">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                <input type="password" id="password" autocomplete="off" placeholder="Ø§Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
            </div>
            <button type="submit" class="login-button">Ø¯Ø®ÙˆÙ„</button>
            <div id="errorBox" class="login-error">Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ ØºÙŠØ± ØµØ­ÙŠØ­Ø©</div>
            <div class="login-hint">
                Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: <b>admin</b> &mdash; ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±: <b>12</b>
            </div>
        </form>
    </div>
</div>

<div class="app-shell" id="mainApp" style="display:none;">

    <header>
        <div class="title-block">
            <h1>Ù„ÙˆØ­Ø© Ù…ØªØ§Ø¨Ø¹Ø© ØªÙ†ÙÙŠØ° Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ Ø¨Ù…Ø¯Ø±Ø³Ø© Ø§Ù„Ø¯ÙÙŠ Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠØ©</h1>
            <span>Ø¥Ø¯Ø®Ø§Ù„ØŒ ØªØ¹Ø¯ÙŠÙ„ØŒ Ø§Ø³ØªÙŠØ±Ø§Ø¯ ÙˆØªØµØ¯ÙŠØ± Ù…Ù† Ø§Ù„Ù…ØªØµÙØ­ Ù…Ø¨Ø§Ø´Ø±Ø©</span>
        </div>
        <div class="header-tags">
            <div class="tag">Ù…Ø¯Ø±Ø³Ø© Ø§Ù„Ø¯ÙÙŠ Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠØ©</div>
            <div class="tag">Ø®Ø·Ø© Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© 1447 Ù‡Ù€</div>
        </div>
    </header>

    <main>
        <div class="main-inner">

            <!-- KPIs -->
            <div class="kpi-row">
                <div class="kpi-card kpi-green">
                    <div class="kpi-inner">
                        <div class="kpi-label">Ù†Ø³Ø¨Ø© Ø§Ù„Ø¥Ù†Ø¬Ø§Ø² Ø§Ù„Ø¹Ø§Ù…Ø©</div>
                        <div class="kpi-value" id="kpiCompletion">0%</div>
                        <div class="kpi-sub">Ù…Ù† Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„Ù…Ø³Ø¬Ù„Ø©</div>
                    </div>
                </div>
                <div class="kpi-card kpi-blue">
                    <div class="kpi-inner">
                        <div class="kpi-label">Ø£Ø¹Ù…Ø§Ù„ Ù…ÙƒØªÙ…Ù„Ø©</div>
                        <div class="kpi-value" id="kpiDone">0</div>
                        <div class="kpi-sub">Ø­Ø§Ù„ØªÙ‡Ø§ (ØªÙ…)</div>
                    </div>
                </div>
                <div class="kpi-card kpi-amber">
                    <div class="kpi-inner">
                        <div class="kpi-label">Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ° / Ù…ØªØ£Ø®Ø±Ø©</div>
                        <div class="kpi-value" id="kpiActive">0</div>
                        <div class="kpi-sub">ØªØ­ØªØ§Ø¬ Ù…ØªØ§Ø¨Ø¹Ø©</div>
                    </div>
                </div>
            </div>

            <!-- Form + Charts -->
            <div class="top-grid">
                <section>
                    <div class="card">
                        <div class="card-header">
                            <span class="card-title">Ø¥Ø¶Ø§ÙØ© Ø¹Ù…Ù„ Ø¬Ø¯ÙŠØ¯</span>
                            <span class="pill">Ø¥Ø¯Ø®Ø§Ù„ Ø³Ø±ÙŠØ¹</span>
                        </div>
                        <form id="taskForm">
                            <div class="form-grid">
                                <div class="full">
                                    <label for="workInput">Ø§Ù„Ø¹Ù…Ù„</label>
                                    <input id="workInput" name="work" type="text" required autocomplete="off"
                                           placeholder="Ù…Ø«Ø§Ù„: Ù…ØªØ§Ø¨Ø¹Ø© ØªÙØ¹ÙŠÙ„ Ù…Ù†ØµØ© Ù…Ø¯Ø±Ø³ØªÙŠ Ù„Ù„Ø·Ù„Ø§Ø¨">
                                </div>
                                <div>
                                    <label for="fieldInput">Ù…Ø¬Ø§Ù„ Ø§Ù„ØªÙ†ÙÙŠØ°</label>
                                    <select id="fieldInput" name="field">
                                        <option value="Ù…ÙƒØªØ¨ÙŠ">Ù…ÙƒØªØ¨ÙŠ</option>
                                        <option value="Ø¯Ø§Ø®Ù„ÙŠ">Ø¯Ø§Ø®Ù„ÙŠ</option>
                                        <option value="Ø®Ø§Ø±Ø¬ÙŠ">Ø®Ø§Ø±Ø¬ÙŠ</option>
                                        <option value="Ø·Ù„Ø§Ø¨">Ø·Ù„Ø§Ø¨</option>
                                        <option value="Ø£Ù†Ø´Ø·Ø©">Ø£Ù†Ø´Ø·Ø©</option>
                                        <option value="Ø¥Ø¯Ø§Ø±ÙŠ">Ø¥Ø¯Ø§Ø±ÙŠ</option>
                                        <option value="Ø£Ø®Ø±Ù‰">Ø£Ø®Ø±Ù‰</option>
                                    </select>
                                </div>
                                <div>
                                    <label for="weekInput">Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</label>
                                    <select id="weekInput" name="week" required>
                                        <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</option>
                                        <option>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„ØªÙ…Ù‡ÙŠØ¯ÙŠ</option>
                                        <option>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø£ÙˆÙ„</option>
                                        <option>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø«Ø§Ù†ÙŠ</option>
                                        <option>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø«Ø§Ù„Ø«</option>
                                        <option>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø±Ø§Ø¨Ø¹</option>
                                        <option>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø®Ø§Ù…Ø³</option>
                                        <option>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø³Ø§Ø¯Ø³</option>
                                        <option>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø³Ø§Ø¨Ø¹</option>
                                        <option>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø«Ø§Ù…Ù†</option>
                                        <option>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„ØªØ§Ø³Ø¹</option>
                                        <option>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø¹Ø§Ø´Ø±</option>
                                        <option>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø­Ø§Ø¯ÙŠ Ø¹Ø´Ø±</option>
                                        <option>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø«Ø§Ù†ÙŠ Ø¹Ø´Ø±</option>
                                        <option>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø«Ø§Ù„Ø« Ø¹Ø´Ø±</option>
                                        <option>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø±Ø§Ø¨Ø¹ Ø¹Ø´Ø±</option>
                                        <option>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø®Ø§Ù…Ø³ Ø¹Ø´Ø±</option>
                                        <option>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø³Ø§Ø¯Ø³ Ø¹Ø´Ø±</option>
                                        <option>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø³Ø§Ø¨Ø¹ Ø¹Ø´Ø±</option>
                                        <option>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø«Ø§Ù…Ù† Ø¹Ø´Ø±</option>
                                    </select>
                                </div>
                                <div>
                                    <label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</label>
                                    <div class="week-date-pill" id="weekDateLabel">Ù„Ù… ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø£Ø³Ø¨ÙˆØ¹</div>
                                </div>
                                <div>
                                    <label for="ownerInput">Ø§Ù„Ù…Ù†ÙØ°</label>
                                    <select id="ownerInput" name="owner">
                                        <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ù†ÙØ°</option>
                                        <option>Ù…Ø³ÙØ± Ø§Ù„Ø±Ø´ÙŠØ¯ÙŠ</option>
                                        <option>ØµØ§Ù„Ø­ Ø§Ù„Ù‚Ø­Ø·Ø§Ù†ÙŠ</option>
                                        <option>ØºØ§Ø²ÙŠ Ø§Ù„Ù…Ø·ÙŠØ±ÙŠ</option>
                                        <option>Ù…Ø­Ù…Ø¯ Ø§Ù„Ø£Ø­Ù…Ø±ÙŠ</option>
                                        <option>Ø±Ø§Ø´Ø¯ Ø§Ù„Ù…Ø±ÙŠ</option>
                                        <option>ÙŠØ­ÙŠÙ‰ Ù…Ø¬Ø±Ø´ÙŠ</option>
                                        <option>Ø®Ø§Ù„Ø¯ Ø§Ù„Ø´Ø§Ø±Ø®</option>
                                        <option>Ø¹Ø¨Ø¯Ø§Ù„Ù‚Ø§Ø¯Ø± Ø§Ù„ØºØ§Ù…Ø¯ÙŠ</option>
                                    </select>
                                </div>
                                <div>
                                    <label for="statusInput">Ø­Ø§Ù„Ø© Ø§Ù„ØªÙ†ÙÙŠØ°</label>
                                    <select id="statusInput" name="status">
                                        <option>ØªÙ…</option>
                                        <option>Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°</option>
                                        <option>Ù„Ù… ÙŠØ¨Ø¯Ø£</option>
                                        <option>Ù…ØªØ£Ø®Ø±</option>
                                    </select>
                                </div>
                                <div>
                                    <label for="commentInput">ØªØ¹Ù„ÙŠÙ‚ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</label>
                                    <input id="commentInput" name="comment" type="text" autocomplete="off">
                                </div>
                                <div class="full">
                                    <label for="notesInput">Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
                                    <textarea id="notesInput" name="notes"></textarea>
                                </div>
                                <div class="full" style="text-align:left;">
                                    <button type="submit" class="btn-primary">
                                        <span class="icon">ï¼‹</span>
                                        <span>Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø¹Ù…Ù„</span>
                                    </button>
                                </div>
                            </div>
                            <p class="week-date-hint">
                                ÙŠØªÙ… Ø¶Ø¨Ø· Ø§Ù„ØªØ§Ø±ÙŠØ® ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ø­Ø³Ø¨ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø£Ø³Ø§Ø¨ÙŠØ¹ Ø§Ù„Ù…Ø¹ØªÙ…Ø¯ØŒ ÙˆÙ„Ø§ Ø­Ø§Ø¬Ø© Ù„Ø¥Ø¯Ø®Ø§Ù„Ù‡ ÙŠØ¯ÙˆÙŠÙ‹Ø§.
                            </p>
                        </form>
                    </div>
                </section>

                <section>
                    <div class="card">
                        <div class="card-header">
                            <span class="card-title">Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø© Ø³Ø±ÙŠØ¹Ø©</span>
                            <span class="pill">Ø­Ø³Ø¨ Ø§Ù„Ù…Ø¬Ø§Ù„Ø§Øª ÙˆØ§Ù„Ø£Ø³Ø§Ø¨ÙŠØ¹</span>
                        </div>
                        <div class="charts-grid">
                            <div>
                                <canvas id="fieldChart" height="150"></canvas>
                            </div>
                            <div>
                                <canvas id="weekChart" height="150"></canvas>
                            </div>
                        </div>
                    </div>
                </section>
            </div>

            <!-- Table -->
            <section>
                <div class="card">
                    <div class="card-header">
                        <span class="card-title">Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„ØªÙØµÙŠÙ„ÙŠ</span>
                        <div class="header-actions">
                            <button type="button" class="btn-secondary" id="btnImportExcel">Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù…Ù† Excel</button>
                            <button type="button" class="btn-secondary" id="btnExportExcel">ØªØµØ¯ÙŠØ± Excel</button>
                            <button type="button" class="btn-secondary" id="btnExportPDF">ØªØµØ¯ÙŠØ± PDF</button>
                            <button type="button" class="btn-secondary" id="btnResetFilters">Ù…Ø³Ø­ Ø§Ù„ÙÙ„Ø§ØªØ±</button>
                            <button type="button" class="btn-danger" id="btnDeleteAll">Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø³Ø¬Ù„Ø§Øª</button>
                            <input type="file" id="excelFileInput" accept=".xlsx,.xls" style="display:none;">
                        </div>
                    </div>
                    <div class="filter-row">
                        <div class="filter-item">
                            <label for="filterWeek">ØªØµÙÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</label>
                            <select id="filterWeek">
                                <option value="">ÙƒÙ„ Ø§Ù„Ø£Ø³Ø§Ø¨ÙŠØ¹</option>
                                <option>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„ØªÙ…Ù‡ÙŠØ¯ÙŠ</option>
                                <option>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø£ÙˆÙ„</option>
                                <option>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø«Ø§Ù†ÙŠ</option>
                                <option>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø«Ø§Ù„Ø«</option>
                                <option>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø±Ø§Ø¨Ø¹</option>
                                <option>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø®Ø§Ù…Ø³</option>
                                <option>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø³Ø§Ø¯Ø³</option>
                                <option>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø³Ø§Ø¨Ø¹</option>
                                <option>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø«Ø§Ù…Ù†</option>
                                <option>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„ØªØ§Ø³Ø¹</option>
                                <option>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø¹Ø§Ø´Ø±</option>
                                <option>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø­Ø§Ø¯ÙŠ Ø¹Ø´Ø±</option>
                                <option>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø«Ø§Ù†ÙŠ Ø¹Ø´Ø±</option>
                                <option>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø«Ø§Ù„Ø« Ø¹Ø´Ø±</option>
                                <option>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø±Ø§Ø¨Ø¹ Ø¹Ø´Ø±</option>
                                <option>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø®Ø§Ù…Ø³ Ø¹Ø´Ø±</option>
                                <option>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø³Ø§Ø¯Ø³ Ø¹Ø´Ø±</option>
                                <option>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø³Ø§Ø¨Ø¹ Ø¹Ø´Ø±</option>
                                <option>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø«Ø§Ù…Ù† Ø¹Ø´Ø±</option>
                            </select>
                        </div>
                        <div class="filter-item">
                            <label for="filterOwner">ØªØµÙÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ù…Ù†ÙØ°</label>
                            <select id="filterOwner">
                                <option value="">ÙƒÙ„ Ø§Ù„Ù…Ù†ÙØ°ÙŠÙ†</option>
                                <option>Ù…Ø³ÙØ± Ø§Ù„Ø±Ø´ÙŠØ¯ÙŠ</option>
                                <option>ØµØ§Ù„Ø­ Ø§Ù„Ù‚Ø­Ø·Ø§Ù†ÙŠ</option>
                                <option>ØºØ§Ø²ÙŠ Ø§Ù„Ù…Ø·ÙŠØ±ÙŠ</option>
                                <option>Ù…Ø­Ù…Ø¯ Ø§Ù„Ø£Ø­Ù…Ø±ÙŠ</option>
                                <option>Ø±Ø§Ø´Ø¯ Ø§Ù„Ù…Ø±ÙŠ</option>
                                <option>ÙŠØ­ÙŠÙ‰ Ù…Ø¬Ø±Ø´ÙŠ</option>
                                <option>Ø®Ø§Ù„Ø¯ Ø§Ù„Ø´Ø§Ø±Ø®</option>
                                <option>Ø¹Ø¨Ø¯Ø§Ù„Ù‚Ø§Ø¯Ø± Ø§Ù„ØºØ§Ù…Ø¯ÙŠ</option>
                            </select>
                        </div>
                        <div class="filter-item">
                            <label for="filterStatus">ØªØµÙÙŠØ© Ø­Ø³Ø¨ Ø­Ø§Ù„Ø© Ø§Ù„ØªÙ†ÙÙŠØ°</label>
                            <select id="filterStatus">
                                <option value="">ÙƒÙ„ Ø§Ù„Ø­Ø§Ù„Ø§Øª</option>
                                <option>ØªÙ…</option>
                                <option>Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°</option>
                                <option>Ù„Ù… ÙŠØ¨Ø¯Ø£</option>
                                <option>Ù…ØªØ£Ø®Ø±</option>
                            </select>
                        </div>
                    </div>

                    <table id="tasksTable" class="display" style="width:100%">
                        <thead>
                        <tr>
                            <th>Ù…</th>
                            <th>Ø§Ù„Ø¹Ù…Ù„</th>
                            <th>Ø§Ù„Ù…Ø¬Ø§Ù„</th>
                            <th>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</th>
                            <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</th>
                            <th>Ø§Ù„Ù…Ù†ÙØ°</th>
                            <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                            <th>ØªØ¹Ù„ÙŠÙ‚</th>
                            <th>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</th>
                            <th>Ø­Ø°Ù</th>
                        </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                    <div class="footer-note">
                        ÙŠØªÙ… Ø­ÙØ¸ Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ Ø¯Ø§Ø®Ù„ Ù…ØªØµÙØ­Ùƒ (localStorage) ÙˆÙŠÙ…ÙƒÙ† ØªØ¹Ø¯ÙŠÙ„Ù‡Ø§ Ù…Ø¨Ø§Ø´Ø±Ø© Ù…Ù† Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø£Ùˆ Ø§Ø³ØªÙŠØ±Ø§Ø¯Ù‡Ø§ Ù…Ù† Ù…Ù„Ù Excel.
                    </div>
                </div>
            </section>

        </div>
    </main>
</div>

<script>
    let tasks = [];
    let dataTable;
    let fieldChart, weekChart;

    const STORAGE_KEY = "mutaba_tasks_full_v2";

    const weekDates = {
        "Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„ØªÙ…Ù‡ÙŠØ¯ÙŠ": "1447/2/24 Ù‡Ù€",
        "Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø£ÙˆÙ„": "1447/3/1 Ù‡Ù€",
        "Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø«Ø§Ù†ÙŠ": "1447/3/8 Ù‡Ù€",
        "Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø«Ø§Ù„Ø«": "1447/3/15 Ù‡Ù€",
        "Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø±Ø§Ø¨Ø¹": "1447/3/22 Ù‡Ù€",
        "Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø®Ø§Ù…Ø³": "1447/3/29 Ù‡Ù€",
        "Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø³Ø§Ø¯Ø³": "1447/4/6 Ù‡Ù€",
        "Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø³Ø§Ø¨Ø¹": "1447/4/13 Ù‡Ù€",
        "Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø«Ø§Ù…Ù†": "1447/4/20 Ù‡Ù€",
        "Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„ØªØ§Ø³Ø¹": "1447/4/27 Ù‡Ù€",
        "Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø¹Ø§Ø´Ø±": "1447/5/4 Ù‡Ù€",
        "Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø­Ø§Ø¯ÙŠ Ø¹Ø´Ø±": "1447/5/11 Ù‡Ù€",
        "Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø«Ø§Ù†ÙŠ Ø¹Ø´Ø±": "1447/5/18 Ù‡Ù€",
        "Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø«Ø§Ù„Ø« Ø¹Ø´Ø±": "1447/5/25 Ù‡Ù€",
        "Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø±Ø§Ø¨Ø¹ Ø¹Ø´Ø±": "1447/6/9 Ù‡Ù€",
        "Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø®Ø§Ù…Ø³ Ø¹Ø´Ø±": "1447/6/16 Ù‡Ù€",
        "Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø³Ø§Ø¯Ø³ Ø¹Ø´Ø±": "1447/6/23 Ù‡Ù€",
        "Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø³Ø§Ø¨Ø¹ Ø¹Ø´Ø±": "1447/7/1 Ù‡Ù€",
        "Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø«Ø§Ù…Ù† Ø¹Ø´Ø±": "1447/7/8 Ù‡Ù€"
    };

    function normalizeStatus(value) {
        if (!value) return "ØºÙŠØ± Ù…Ø­Ø¯Ø¯";
        const v = String(value).trim();
        if (v.includes("ØªÙ…")) return "ØªÙ…";
        if (v.includes("Ø¬Ø§Ø±ÙŠ") || v.includes("Ù‚ÙŠØ¯")) return "Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°";
        if (v.includes("Ù…ØªØ£Ø®Ø±")) return "Ù…ØªØ£Ø®Ø±";
        if (v.includes("Ù„Ù…")) return "Ù„Ù… ÙŠØ¨Ø¯Ø£";
        return v;
    }

    function normalizeWeek(value) {
        if (!value) return "";
        let v = String(value).trim();
        // ØªÙˆØ­ÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø¨Ø¯ÙˆÙ† Ù‡Ù…Ø²Ø© Ø£Ùˆ Ù…Ø¹ Ø£Ø®Ø·Ø§Ø¡ Ø¨Ø³ÙŠØ·Ø©
        v = v.replace(/^Ø§Ø³Ø¨ÙˆØ¹/i, "Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹")
             .replace(/^Ø§Ù„Ø§Ø³Ø¨ÙˆØ¹/i, "Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹")
             .replace(/^Ù„Ø§Ø³Ø¨ÙˆØ¹/i, "Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹")
             .replace(/^Ù„Ø£Ø³Ø¨ÙˆØ¹/i, "Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹");

        // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù…Ø³Ø§ÙØ§Øª Ø§Ù„Ù…ÙƒØ±Ø±Ø©
        v = v.replace(/\s+/g, " ");

        // Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„ØªÙ…Ù‡ÙŠØ¯ÙŠ
        if (v.includes("ØªÙ…Ù‡ÙŠØ¯ÙŠ")) return "Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„ØªÙ…Ù‡ÙŠØ¯ÙŠ";

        // Ø£Ø´ÙƒØ§Ù„ Ù…Ø®ØªÙ„ÙØ© Ù„Ù„Ø£ÙˆÙ„
        if (v.includes("Ø§Ù„Ø£ÙˆÙ„") || v.includes("Ø§Ù„Ø§ÙˆÙ„")) return "Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø£ÙˆÙ„";
        if (v.includes("Ø§Ù„Ø«Ø§Ù†ÙŠ")) return "Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø«Ø§Ù†ÙŠ";
        if (v.includes("Ø§Ù„Ø«Ø§Ù„Ø«")) return "Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø«Ø§Ù„Ø«";
        if (v.includes("Ø§Ù„Ø±Ø§Ø¨Ø¹")) return "Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø±Ø§Ø¨Ø¹";
        if (v.includes("Ø§Ù„Ø®Ø§Ù…Ø³")) return "Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø®Ø§Ù…Ø³";
        if (v.includes("Ø§Ù„Ø³Ø§Ø¯Ø³")) return "Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø³Ø§Ø¯Ø³";
        if (v.includes("Ø§Ù„Ø³Ø§Ø¨Ø¹")) return "Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø³Ø§Ø¨Ø¹";
        if (v.includes("Ø§Ù„Ø«Ø§Ù…Ù†")) return "Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø«Ø§Ù…Ù†";
        if (v.includes("Ø§Ù„ØªØ§Ø³Ø¹")) return "Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„ØªØ§Ø³Ø¹";
        if (v.includes("Ø§Ù„Ø¹Ø§Ø´Ø±")) return "Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø¹Ø§Ø´Ø±";
        if (v.includes("Ø§Ù„Ø­Ø§Ø¯ÙŠ Ø¹Ø´Ø±")) return "Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø­Ø§Ø¯ÙŠ Ø¹Ø´Ø±";
        if (v.includes("Ø§Ù„Ø«Ø§Ù†ÙŠ Ø¹Ø´Ø±")) return "Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø«Ø§Ù†ÙŠ Ø¹Ø´Ø±";
        if (v.includes("Ø§Ù„Ø«Ø§Ù„Ø« Ø¹Ø´Ø±")) return "Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø«Ø§Ù„Ø« Ø¹Ø´Ø±";
        if (v.includes("Ø§Ù„Ø±Ø§Ø¨Ø¹ Ø¹Ø´Ø±")) return "Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø±Ø§Ø¨Ø¹ Ø¹Ø´Ø±";
        if (v.includes("Ø§Ù„Ø®Ø§Ù…Ø³ Ø¹Ø´Ø±")) return "Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø®Ø§Ù…Ø³ Ø¹Ø´Ø±";
        if (v.includes("Ø§Ù„Ø³Ø§Ø¯Ø³ Ø¹Ø´Ø±")) return "Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø³Ø§Ø¯Ø³ Ø¹Ø´Ø±";
        if (v.includes("Ø§Ù„Ø³Ø§Ø¨Ø¹ Ø¹Ø´Ø±")) return "Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø³Ø§Ø¨Ø¹ Ø¹Ø´Ø±";
        if (v.includes("Ø§Ù„Ø«Ø§Ù…Ù† Ø¹Ø´Ø±")) return "Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø«Ø§Ù…Ù† Ø¹Ø´Ø±";

        return v;
    }

    function persistTasks() {
        // Ø¥Ø±Ø³Ø§Ù„ Ø¢Ø®Ø± ØµÙ ÙÙ‚Ø· (ÙŠÙ…ÙƒÙ†Ùƒ ØªØ¹Ø¯ÙŠÙ„Ù‡Ø§ Ù„Ø¥Ø±Ø³Ø§Ù„ ÙƒÙ„ Ø§Ù„ØµÙÙˆÙ)
        const lastTask = tasks[tasks.length - 1];
        if (!lastTask) return;
        fetch('http://localhost:3000/api/sheet', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                row: [
                    lastTask.work,
                    lastTask.field,
                    lastTask.week,
                    lastTask.date,
                    lastTask.owner,
                    lastTask._status,
                    lastTask.comment,
                    lastTask.notes
                ]
            })
        })
        .then(res => res.json())
        .then(data => {
            if (!data.success) alert("ØªØ¹Ø°Ø± Ø­ÙØ¸ Ø§Ù„Ø¹Ù…Ù„ ÙÙŠ Google Sheets");
        })
        .catch(e => alert("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…"));
    }

    function loadTasksFromStorage() {
        fetch('http://localhost:3000/api/sheet')
            .then(res => res.json())
            .then(parsed => {
                if (Array.isArray(parsed)) {
                    tasks = parsed.map((row) => {
                        // ØªØ£ÙƒØ¯ Ù…Ù† ØªØ±ØªÙŠØ¨ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© Ø­Ø³Ø¨ Ø§Ù„Ø¬Ø¯ÙˆÙ„
                        const [work, field, week, date, owner, _status, comment, notes] = row;
                        const w = normalizeWeek(week || "");
                        return {
                            work: work || "",
                            field: field || "",
                            week: w,
                            date: date || (weekDates[w] || ""),
                            owner: owner || "",
                            _status: normalizeStatus(_status || ""),
                            comment: comment || "",
                            notes: notes || ""
                        };
                    });
                    updateKpis();
                    rebuildCharts();
                    rebuildTable();
                }
            })
            .catch(e => console.warn("ØªØ¹Ø°Ø± Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù…", e));
    }

    function updateKpis() {
        const total = tasks.length;
        const done = tasks.filter(t => t._status === "ØªÙ…").length;
        const inProgress = tasks.filter(t => t._status === "Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°").length;
        const others = total - done;

        const completion = total ? Math.round((done / total) * 100) : 0;

        document.getElementById("kpiCompletion").textContent = completion + "%";
        document.getElementById("kpiDone").textContent = done;
        document.getElementById("kpiActive").textContent = inProgress + (others - inProgress);
    }

    function destroyChart(ch) {
        if (ch) ch.destroy();
    }

    function groupBy(list, keyFn) {
        const map = {};
        list.forEach(item => {
            const key = keyFn(item) || "ØºÙŠØ± Ù…Ø­Ø¯Ø¯";
            map[key] = (map[key] || 0) + 1;
        });
        return map;
    }

    function rebuildCharts() {
        const ctxField = document.getElementById("fieldChart");
        const ctxWeek = document.getElementById("weekChart");

        destroyChart(fieldChart);
        destroyChart(weekChart);

        const fieldCounts = groupBy(tasks, t => t.field);
        fieldChart = new Chart(ctxField, {
            type: "doughnut",
            data: {
                labels: Object.keys(fieldCounts),
                datasets: [{
                    data: Object.values(fieldCounts)
                }]
            },
            options: {
                plugins: { legend: { position: "bottom" } }
            }
        });

        const weekCounts = groupBy(tasks, t => t.week);
        const orderedWeeks = Object.keys(weekDates).filter(w => weekCounts[w]);
        weekChart = new Chart(ctxWeek, {
            type: "line",
            data: {
                labels: orderedWeeks,
                datasets: [{
                    data: orderedWeeks.map(w => weekCounts[w] || 0),
                    tension: 0.3
                }]
            },
            options: {
                plugins: { legend: { display: false } },
                scales: { y: { beginAtZero: true } }
            }
        });
    }

    function getActiveFilters() {
        const fw = document.getElementById("filterWeek");
        const fo = document.getElementById("filterOwner");
        const fs = document.getElementById("filterStatus");
        return {
            week: fw ? normalizeWeek(fw.value) : "",
            owner: fo ? fo.value.trim() : "",
            status: fs ? fs.value.trim() : ""
        };
    }

    function getFilteredTasks() {
        const filters = getActiveFilters();
        return tasks.filter(t => {
            let ok = true;
            const tWeek = normalizeWeek(t.week || "");
            const tOwner = (t.owner || "").trim();
            const tStatus = (t._status || "").trim();
            if (filters.week) ok = ok && tWeek === filters.week;
            if (filters.owner) ok = ok && tOwner === filters.owner;
            if (filters.status) ok = ok && tStatus === filters.status;
            return ok;
        });
    }

    function applyRowStatusClass(tr, status) {
        tr.classList.remove("row-done", "row-progress", "row-late");
        const s = normalizeStatus(status);
        if (s === "ØªÙ…") {
            tr.classList.add("row-done");
        } else if (s === "Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°") {
            tr.classList.add("row-progress");
        } else {
            tr.classList.add("row-late");
        }
    }

    function rebuildTable() {
        const tbody = document.querySelector("#tasksTable tbody");

        // ØªØ¯Ù…ÙŠØ± Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù‚Ø¯ÙŠÙ… Ø¥Ù† ÙˆØ¬Ø¯
        if (dataTable) {
            dataTable.destroy();
            dataTable = null;
        }

        // ØªÙØ±ÙŠØº Ø§Ù„ØµÙÙˆÙ
        tbody.innerHTML = "";

        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø¹Ø¯ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„Ø§ØªØ±
        const filtered = getFilteredTasks();

        // Ø¨Ù†Ø§Ø¡ Ø§Ù„ØµÙÙˆÙ
        filtered.forEach((t, i) => {
            const idx = tasks.indexOf(t);
            const tr = document.createElement("tr");
            tr.dataset.idx = idx;
            tr.innerHTML = `
                <td>${i + 1}</td>
                <td contenteditable="true" data-field="work">${t.work}</td>
                <td contenteditable="true" data-field="field">${t.field}</td>
                <td contenteditable="true" data-field="week">${t.week}</td>
                <td contenteditable="true" data-field="date">${t.date}</td>
                <td contenteditable="true" data-field="owner">${t.owner}</td>
                <td contenteditable="true" data-field="_status">${t._status}</td>
                <td contenteditable="true" data-field="comment">${t.comment}</td>
                <td contenteditable="true" data-field="notes">${t.notes}</td>
                <td><button type="button" class="btn-delete" title="Ø­Ø°Ù">ğŸ—‘</button></td>
            `;
            applyRowStatusClass(tr, t._status);
            tbody.appendChild(tr);
        });

        // Ø¥Ø¹Ø§Ø¯Ø© ØªÙ‡ÙŠØ¦Ø© DataTable Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©
        dataTable = new DataTable("#tasksTable", {
            language: { url: "https://cdn.datatables.net/plug-ins/1.13.7/i18n/ar.json" },
            pageLength: 25
        });
    }

    // ØªØ­Ø¯ÙŠØ« Ù†Øµ ØªØ§Ø±ÙŠØ® Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹Ø® Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹
    const weekSelect = document.getElementById("weekInput");
    const weekDateLabel = document.getElementById("weekDateLabel");
    weekSelect.addEventListener("change", () => {
        const w = weekSelect.value;
        if (weekDates[w]) {
            weekDateLabel.textContent = weekDates[w];
        } else {
            weekDateLabel.textContent = "Ù„Ù… ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø£Ø³Ø¨ÙˆØ¹";
        }
    });

    // Ø¥Ø¶Ø§ÙØ© Ø¹Ù…Ù„ Ø¬Ø¯ÙŠØ¯
    const form = document.getElementById("taskForm");
    form.addEventListener("submit", (e) => {
        e.preventDefault();
        const work = document.getElementById("workInput").value.trim();
        if (!work) return;

        const field = document.getElementById("fieldInput").value;
        const weekRaw = document.getElementById("weekInput").value;
        const week = normalizeWeek(weekRaw);
        if (!week) {
            alert("ÙØ¶Ù„Ø§Ù‹ Ø§Ø®ØªØ± Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹.");
            return;
        }
        const date = weekDates[week] || "";
        const owner = document.getElementById("ownerInput").value;
        const statusRaw = document.getElementById("statusInput").value;
        const status = normalizeStatus(statusRaw);
        const comment = document.getElementById("commentInput").value.trim();
        const notes = document.getElementById("notesInput").value.trim();

        const task = { work, field, week, date, owner, _status: status, comment, notes };
        tasks.push(task);

        persistTasks();
        updateKpis();
        rebuildCharts();
        rebuildTable();

        form.reset();
        weekDateLabel.textContent = "Ù„Ù… ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø£Ø³Ø¨ÙˆØ¹";
        document.getElementById("workInput").focus();
    });

    // ØªØ¹Ø¯ÙŠÙ„ Ù…Ø¨Ø§Ø´Ø± Ù…Ù† Ø§Ù„Ø¬Ø¯ÙˆÙ„
    const tbodyEl = document.querySelector("#tasksTable tbody");
    tbodyEl.addEventListener("blur", (e) => {
        const cell = e.target;
        if (!cell.matches("[contenteditable][data-field]")) return;
        const tr = cell.closest("tr");
        if (!tr) return;
        const idx = parseInt(tr.dataset.idx, 10);
        if (isNaN(idx) || !tasks[idx]) return;

        const field = cell.dataset.field;
        let val = cell.textContent.trim();

        if (field === "week") {
            const w = normalizeWeek(val);
            tasks[idx].week = w;
            if (weekDates[w]) {
                tasks[idx].date = weekDates[w];
                const dateCell = tr.querySelector('[data-field="date"]');
                if (dateCell) dateCell.textContent = tasks[idx].date;
            }
        } else if (field === "_status") {
            tasks[idx]._status = normalizeStatus(val);
            cell.textContent = tasks[idx]._status;
            applyRowStatusClass(tr, tasks[idx]._status);
        } else if (field === "date") {
            tasks[idx].date = val;
        } else if (field === "work" || field === "field" || field === "owner" ||
                   field === "comment" || field === "notes") {
            tasks[idx][field] = val;
        }

        persistTasks();
        updateKpis();
        rebuildCharts();
    }, true);

    // Ø­Ø°Ù Ø³Ø¬Ù„ Ù…Ù† Ø§Ù„Ø¬Ø¯ÙˆÙ„
    tbodyEl.addEventListener("click", (e) => {
        const btn = e.target.closest(".btn-delete");
        if (!btn) return;
        const tr = btn.closest("tr");
        if (!tr) return;
        const idx = parseInt(tr.dataset.idx, 10);
        if (isNaN(idx) || !tasks[idx]) return;
        if (!confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù…Ù„ØŸ")) return;
        tasks.splice(idx, 1);
        persistTasks();
        updateKpis();
        rebuildCharts();
        rebuildTable();
    });

    // Ø±Ø¨Ø· Ø§Ù„ÙÙ„Ø§ØªØ±
    const fw = document.getElementById("filterWeek");
    const fo = document.getElementById("filterOwner");
    const fs = document.getElementById("filterStatus");
    if (fw) fw.addEventListener("change", () => rebuildTable());
    if (fo) fo.addEventListener("change", () => rebuildTable());
    if (fs) fs.addEventListener("change", () => rebuildTable());

    // Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù…Ù† Excel
    function findColumnIndex(headers, candidates) {
        const normalized = headers.map(h => String(h || "").trim());
        for (const cand of candidates) {
            const c = String(cand).trim();
            let idx = normalized.findIndex(h => h === c);
            if (idx !== -1) return idx;
            idx = normalized.findIndex(h => h.includes(c) || c.includes(h));
            if (idx !== -1) return idx;
        }
        return -1;
    }

    function importFromExcelFile(file) {
        const reader = new FileReader();
        reader.onload = function(e) {
            try {
                const data = new Uint8Array(e.target.result);
                const workbook = XLSX.read(data, { type: "array" });
                const firstSheetName = workbook.SheetNames[0];
                const sheet = workbook.Sheets[firstSheetName];
                const rows = XLSX.utils.sheet_to_json(sheet, { header: 1, defval: "" });

                if (!rows.length) {
                    alert("Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ù…Ù„Ù Excel.");
                    return;
                }

                const headers = rows[0];
                const body = rows.slice(1);

                const idxWork   = findColumnIndex(headers, ["Ø§Ù„Ø¹Ù…Ù„", "Ø§Ù„Ù…Ù‡Ù…Ø©", "Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡"]);
                const idxField  = findColumnIndex(headers, ["Ø§Ù„Ù…Ø¬Ø§Ù„", "Ù…Ø¬Ø§Ù„ Ø§Ù„ØªÙ†ÙÙŠØ°"]);
                const idxWeek   = findColumnIndex(headers, ["Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹", "Ø§Ù„Ø§Ø³Ø¨ÙˆØ¹"]);
                const idxDate   = findColumnIndex(headers, ["Ø§Ù„ØªØ§Ø±ÙŠØ®", "ØªØ§Ø±ÙŠØ® Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹"]);
                const idxOwner  = findColumnIndex(headers, ["Ø§Ù„Ù…Ù†ÙØ°", "Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„"]);
                const idxStatus = findColumnIndex(headers, ["Ø§Ù„Ø­Ø§Ù„Ø©", "Ø­Ø§Ù„Ø© Ø§Ù„ØªÙ†ÙÙŠØ°"]);
                const idxComment= findColumnIndex(headers, ["ØªØ¹Ù„ÙŠÙ‚", "ØªØ¹Ù„ÙŠÙ‚ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„"]);
                const idxNotes  = findColumnIndex(headers, ["Ù…Ù„Ø§Ø­Ø¸Ø§Øª", "Ù…Ù„Ø§Ø­Ø¸Ø©"]);

                let importedCount = 0;
                body.forEach((row) => {
                    const cells = row;
                    const work = idxWork >= 0 ? String(cells[idxWork]).trim() : "";
                    if (!work) return;

                    const field = idxField >= 0 ? String(cells[idxField]).trim() : "";
                    const weekRaw  = idxWeek >= 0 ? String(cells[idxWeek]).trim() : "";
                    const week  = normalizeWeek(weekRaw);
                    let date    = idxDate >= 0 ? String(cells[idxDate]).trim() : "";
                    const owner = idxOwner >= 0 ? String(cells[idxOwner]).trim() : "";
                    const statusRaw = idxStatus >= 0 ? String(cells[idxStatus]).trim() : "";
                    const status    = normalizeStatus(statusRaw);
                    const comment   = idxComment >= 0 ? String(cells[idxComment]).trim() : "";
                    const notes     = idxNotes >= 0 ? String(cells[idxNotes]).trim() : "";

                    if (!date && weekDates[week]) {
                        date = weekDates[week];
                    }

                    const task = { work, field, week, date, owner, _status: status, comment, notes };
                    tasks.push(task);
                    importedCount++;
                });

                if (!importedCount) {
                    alert("Ù„Ù… ÙŠØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø£ÙŠ ØµÙ. ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ù…Ù„Ù Excel ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø£Ø¹Ù…Ø¯Ø©: Ø§Ù„Ø¹Ù…Ù„ØŒ Ø§Ù„Ù…Ø¬Ø§Ù„ØŒ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ØŒ Ø§Ù„Ù…Ù†ÙØ°ØŒ Ø§Ù„Ø­Ø§Ù„Ø©.");
                    return;
                }

                persistTasks();
                updateKpis();
                rebuildCharts();
                rebuildTable();

                alert("ØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ " + importedCount + " Ù…Ù† Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ Ù…Ù† Excel Ø¨Ù†Ø¬Ø§Ø­.");
            } catch (err) {
                console.error(err);
                alert("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ù‚Ø±Ø§Ø¡Ø© Ù…Ù„Ù Excel.");
            }
        };
        reader.readAsArrayBuffer(file);
    }

    const inputExcel = document.getElementById("excelFileInput");
    const btnImport = document.getElementById("btnImportExcel");
    if (btnImport && inputExcel) {
        btnImport.addEventListener("click", () => inputExcel.click());
        inputExcel.addEventListener("change", (e) => {
            const file = e.target.files[0];
            if (file) {
                importFromExcelFile(file);
                e.target.value = "";
            }
        });
    }

    // ØªØµØ¯ÙŠØ± Ø¥Ù„Ù‰ Excel
    function exportToExcel() {
        const rows = getFilteredTasks();
        if (!rows.length) {
            alert("Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„ØªØµØ¯ÙŠØ±.");
            return;
        }
        const header = ["Ù…", "Ø§Ù„Ø¹Ù…Ù„", "Ø§Ù„Ù…Ø¬Ø§Ù„", "Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹", "ØªØ§Ø±ÙŠØ® Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹", "Ø§Ù„Ù…Ù†ÙØ°", "Ø§Ù„Ø­Ø§Ù„Ø©", "ØªØ¹Ù„ÙŠÙ‚", "Ù…Ù„Ø§Ø­Ø¸Ø§Øª"];
        const data = rows.map((t, i) => [
            i + 1,
            t.work || "",
            t.field || "",
            t.week || "",
            t.date || "",
            t.owner || "",
            t._status || "",
            t.comment || "",
            t.notes || ""
        ]);
        const aoa = [header, ...data];
        const wb = XLSX.utils.book_new();
        const ws = XLSX.utils.aoa_to_sheet(aoa);
        XLSX.utils.book_append_sheet(wb, ws, "Ø§Ù„Ø£Ø¹Ù…Ø§Ù„");
        XLSX.writeFile(wb, "mutaba_tasks.xlsx");
    }

    // ØªØµØ¯ÙŠØ± Ø¥Ù„Ù‰ PDF
    function exportToPDF() {
        const rows = getFilteredTasks();
        if (!rows.length) {
            alert("Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„ØªØµØ¯ÙŠØ±.");
            return;
        }
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF("l", "pt", "a4");

        const head = [["Ù…", "Ø§Ù„Ø¹Ù…Ù„", "Ø§Ù„Ù…Ø¬Ø§Ù„", "Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹", "Ø§Ù„ØªØ§Ø±ÙŠØ®", "Ø§Ù„Ù…Ù†ÙØ°", "Ø§Ù„Ø­Ø§Ù„Ø©", "ØªØ¹Ù„ÙŠÙ‚", "Ù…Ù„Ø§Ø­Ø¸Ø§Øª"]];
        const body = rows.map((t, i) => [
            String(i + 1),
            t.work || "",
            t.field || "",
            t.week || "",
            t.date || "",
            t.owner || "",
            t._status || "",
            t.comment || "",
            t.notes || ""
        ]);

        doc.setFontSize(12);
        doc.text("ØªÙ‚Ø±ÙŠØ± Ù…ØªØ§Ø¨Ø¹Ø© ØªÙ†ÙÙŠØ° Ø§Ù„Ø£Ø¹Ù…Ø§Ù„", doc.internal.pageSize.getWidth() - 40, 30, { align: "right" });

        doc.autoTable({
            head,
            body,
            startY: 40,
            styles: { fontSize: 8 },
            margin: { right: 20, left: 20 }
        });

        doc.save("mutaba_tasks.pdf");
    }

    document.getElementById("btnExportExcel").addEventListener("click", exportToExcel);
    document.getElementById("btnExportPDF").addEventListener("click", exportToPDF);

    // Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø³Ø¬Ù„Ø§Øª
    const btnDeleteAll = document.getElementById("btnDeleteAll");
    if (btnDeleteAll) {
        btnDeleteAll.addEventListener("click", () => {
            if (!tasks.length) {
                alert("Ù„Ø§ ØªÙˆØ¬Ø¯ Ø³Ø¬Ù„Ø§Øª Ù„Ø­Ø°ÙÙ‡Ø§.");
                return;
            }
            if (!confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø³Ø¬Ù„Ø§ØªØŸ Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡.")) return;
            tasks = [];
            persistTasks();
            updateKpis();
            rebuildCharts();
            rebuildTable();
        });
    }

    
    // Ø²Ø± Ù…Ø³Ø­ Ø§Ù„ÙÙ„Ø§ØªØ± ÙˆØ¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¬Ø¯ÙˆÙ„
    const btnResetFilters = document.getElementById("btnResetFilters");
    if (btnResetFilters) {
        btnResetFilters.addEventListener("click", () => {
            const fw = document.getElementById("filterWeek");
            const fo = document.getElementById("filterOwner");
            const fs = document.getElementById("filterStatus");
            if (fw) fw.value = "";
            if (fo) fo.value = "";
            if (fs) fs.value = "";
            rebuildTable();
        });
    }

// ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø© Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØµÙØ­Ø©
    loadTasksFromStorage();

    // Ø´Ø§Ø´Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¯Ø§Ø®Ù„ Ù†ÙØ³ Ø§Ù„ØµÙØ­Ø©
    (function() {
        const VALID_USER = "admin";
        const VALID_PASS = "12";
        const form = document.getElementById("loginForm");
        const errorBox = document.getElementById("errorBox");
        const loginScreen = document.getElementById("loginScreen");
        const mainApp = document.getElementById("mainApp");

        if (form) {
            form.addEventListener("submit", function(e) {
                e.preventDefault();
                const u = document.getElementById("username").value.trim();
                const p = document.getElementById("password").value.trim();
                if (u === VALID_USER && p === VALID_PASS) {
                    errorBox.style.display = "none";
                    // Ø¥Ø¸Ù‡Ø§Ø± Ù„ÙˆØ­Ø© Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© ÙˆØ¥Ø®ÙØ§Ø¡ Ø´Ø§Ø´Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„
                    if (loginScreen) loginScreen.style.display = "none";
                    if (mainApp) mainApp.style.display = "block";
                } else {
                    errorBox.style.display = "block";
                }
            });
        }
    })();
</script>
</body>
</html>
